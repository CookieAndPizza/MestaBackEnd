<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>LocationResource.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JaCoCoverage analysis of project &quot;Mesta&quot; (powered by JaCoCo from EclEmma)</a> &gt; <a href="index.source.html" class="el_package">com.mesta.resources</a> &gt; <span class="el_source">LocationResource.java</span></div><h1>LocationResource.java</h1><pre class="source lang-java linenums">/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package com.mesta.resources;

import com.mesta.datacommunicators.DatabaseInfo;
import com.mesta.datacontrollers.CommentController;
import com.mesta.datacontrollers.LocationController;
import com.mesta.models.Location;
import com.mesta.models.Comment;
import java.sql.SQLException;
import java.util.ArrayDeque;
import java.util.Deque;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.ws.rs.core.Context;
import javax.ws.rs.core.UriInfo;
import javax.ws.rs.Consumes;
import javax.ws.rs.CookieParam;
import javax.ws.rs.Produces;
import javax.ws.rs.GET;
import javax.ws.rs.POST;
import javax.ws.rs.Path;
import javax.ws.rs.PathParam;
import javax.ws.rs.core.Cookie;
import javax.ws.rs.core.MediaType;
import javax.ws.rs.core.Response;
import javax.ws.rs.core.Response.Status;

/**
 * REST Web Service
 *
 * @author harm
 */
@Path(&quot;/location&quot;)
public class LocationResource {

    @Context
    private UriInfo context;

    /**
     * Creates a new instance of PlaceResource
     */
<span class="nc" id="L46">    public LocationResource() {</span>
<span class="nc" id="L47">    }</span>

    /**
     * Retrieves representation of an instance of
     * com.mesta.resources.PlaceResource
     *
     * @return an instance of java.lang.String
     */
    @GET
    @Path(&quot;/all&quot;)
    @Produces(MediaType.APPLICATION_JSON)
    public Response getAll() {
<span class="nc" id="L59">        Deque locations = new ArrayDeque();</span>
        try {
<span class="nc" id="L61">            locations = LocationController.getController().locationGetter().getAllLocations();</span>
<span class="nc" id="L62">        } catch (SQLException ex) {</span>
<span class="nc" id="L63">            Logger.getLogger(LocationResource.class.getName()).log(Level.SEVERE, null, ex);</span>
<span class="nc" id="L64">        } catch (NullPointerException ex){</span>
<span class="nc" id="L65">            Logger.getLogger(LocationResource.class.getName()).log(Level.SEVERE, null, ex);</span>
<span class="nc" id="L66">            return Response.status(Status.BAD_REQUEST).build();</span>
<span class="nc" id="L67">        }</span>
<span class="nc" id="L68">        return Response.ok(locations.toString(), MediaType.APPLICATION_JSON).build();</span>
    }

    /**
     * POST method for updating or creating an instance of PlaceResource
     *
     * @param content representation for the resource
     */
    @POST
    @Path(&quot;/save&quot;)
    @Consumes(MediaType.APPLICATION_JSON)
    public Response putLocation(Location loc, @CookieParam(&quot;fbLoginID&quot;) Cookie fbLogin, @CookieParam(&quot;token&quot;) Cookie token) {
        try {
<span class="nc" id="L81">            DatabaseInfo.DatabaseRepsonse succes = LocationController.getController().locationSetter().saveLocation(loc, fbLogin.getValue(), token.getValue());</span>
<span class="nc" id="L82">            return Response.ok(String.valueOf(succes)).build();</span>
<span class="nc" id="L83">        } catch (SQLException ex) {</span>
<span class="nc" id="L84">            Logger.getLogger(LocationResource.class.getName()).log(Level.SEVERE, null, ex);</span>
<span class="nc" id="L85">        } catch (NullPointerException ex){</span>
<span class="nc" id="L86">            Logger.getLogger(LocationResource.class.getName()).log(Level.SEVERE, null, ex);</span>
<span class="nc" id="L87">            return Response.status(Status.BAD_REQUEST).build();</span>
<span class="nc" id="L88">        }</span>
<span class="nc" id="L89">        return Response.serverError().build();</span>
    }

    @GET
    @Path(&quot;{ID}&quot;)
    @Produces(MediaType.APPLICATION_JSON)
    public Response getOne(@PathParam(&quot;ID&quot;) int ID) {
<span class="nc" id="L96">        Location location = null;</span>
        try {
<span class="nc" id="L98">            location = LocationController.getController().locationGetter().getOneLocation(ID);</span>

<span class="nc bnc" id="L100" title="All 2 branches missed.">            if (location == null) {</span>
<span class="nc" id="L101">                return Response.status(Response.Status.NOT_FOUND).build();</span>
            }

<span class="nc" id="L104">        } catch (SQLException ex) {</span>
<span class="nc" id="L105">            Logger.getLogger(LocationResource.class.getName()).log(Level.SEVERE, null, ex);</span>
<span class="nc" id="L106">        } catch (NullPointerException ex){</span>
<span class="nc" id="L107">            Logger.getLogger(LocationResource.class.getName()).log(Level.SEVERE, null, ex);</span>
<span class="nc" id="L108">            return Response.status(Status.BAD_REQUEST).build();</span>
<span class="nc" id="L109">        }</span>
<span class="nc bnc" id="L110" title="All 2 branches missed.">        if (location != null) {</span>
<span class="nc" id="L111">            return Response.ok(location.toString(), MediaType.APPLICATION_JSON).build();</span>
        }
<span class="nc" id="L113">        return null;</span>
    }

    /**
     * POST method for updating or creating an instance of PlaceResource
     *
     * @param content representation for the resource
     */
    @GET
    @Path(&quot;/nearby/{Lat}/{Long}/{Range}&quot;)
    @Produces(MediaType.APPLICATION_JSON)
    public Response nearbyLocations(@PathParam(&quot;Lat&quot;) double lat, @PathParam(&quot;Long&quot;) double lon, @PathParam(&quot;Range&quot;) int offset) {
<span class="nc" id="L125">        ArrayDeque locations = new ArrayDeque();</span>
        try {
<span class="nc" id="L127">            locations = LocationController.getController().locationGetter().getNearbyLocations(lat, lon, offset);</span>
<span class="nc" id="L128">        } catch (SQLException ex) {</span>
<span class="nc" id="L129">            Logger.getLogger(LocationResource.class.getName()).log(Level.SEVERE, null, ex);</span>
<span class="nc" id="L130">        } catch (NullPointerException ex){</span>
<span class="nc" id="L131">            Logger.getLogger(LocationResource.class.getName()).log(Level.SEVERE, null, ex);</span>
<span class="nc" id="L132">            return Response.status(Status.BAD_REQUEST).build();</span>
<span class="nc" id="L133">        }</span>
<span class="nc" id="L134">        return Response.ok(locations.toString(), MediaType.APPLICATION_JSON).build();</span>
    }

    @POST
    @Path(&quot;/comment/save&quot;)
    @Consumes(MediaType.APPLICATION_JSON)
    public Response putComment(Comment com, @CookieParam(&quot;fbLoginID&quot;) Cookie fbLogin, @CookieParam(&quot;token&quot;) Cookie token) { 
        try {
<span class="nc" id="L142">            DatabaseInfo.DatabaseRepsonse succes = CommentController.getController().commentSetter().saveComment(com, fbLogin.getValue(), token.getValue());</span>
<span class="nc" id="L143">            return Response.ok(String.valueOf(succes)).build();</span>
<span class="nc" id="L144">        } catch (SQLException ex) {</span>
<span class="nc" id="L145">            Logger.getLogger(LocationResource.class.getName()).log(Level.SEVERE, null, ex);</span>
<span class="nc" id="L146">        } catch (NullPointerException ex){</span>
<span class="nc" id="L147">            Logger.getLogger(LocationResource.class.getName()).log(Level.SEVERE, null, ex);</span>
<span class="nc" id="L148">            return Response.status(Status.BAD_REQUEST).build();</span>
<span class="nc" id="L149">        }</span>
<span class="nc" id="L150">        return Response.serverError().build();</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>